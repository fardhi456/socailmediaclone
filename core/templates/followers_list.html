{% extends 'base.html' %}
{% load static %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<div class="container mt-4">
    <h3>{{ title }}</h3>
    <ul class="list-group mt-3">
        {% for user in users %}
            <li class="list-group-item d-flex align-items-center justify-content-between">
                <div class="d-flex align-items-center">
                    {% if user.profile.profile_picture %}
                        <img src="{{ user.profile.profile_picture.url }}" class="rounded-circle me-3" width="40" height="40" style="object-fit: cover;">
                    {% else %}
                        <img src="{% static 'default_profile.jpg' %}" class="rounded-circle me-3" width="40" height="40" style="object-fit: cover;">
                    {% endif %}

                    {% if user.username %}
                        <a href="{% url 'profile' user.username %}" class="text-decoration-none">
                            {{ user.username }}
                        </a>
                    {% else %}
                        <span>Unknown User</span>
                    {% endif %}
                </div>

                {% if user != request.user %}
                <form method="post" action="{% url 'toggle_follow' user.username %}">
                    {% csrf_token %}
                    {% if request.user in user.profile.followers.all %}
                        <button type="submit" class="btn btn-sm btn-outline-danger">Unfollow</button>
                    {% else %}
                        <button type="submit" class="btn btn-sm btn-outline-primary">Follow</button>
                    {% endif %}
                </form>
                {% endif %}
            </li>
        {% empty %}
            <li class="list-group-item">No users found.</li>
        {% endfor %}
    </ul>
</div>
{% endblock %}
